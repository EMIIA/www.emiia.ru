<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Jersey City Building Footprints</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.26.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.26.0/mapbox-gl.css' rel='stylesheet' />
    <link href='https://fonts.googleapis.com/css?family=Montserrat|Roboto' rel='stylesheet' type='text/css'>
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>


<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-supported/v1.2.0/mapbox-gl-supported.js'></script>

<div id='map'></div>
<div id='menu'>
    <input id='ciux9lxwv00iy2jqneit1egms' type='radio' name='rtoggle' value='ciux9lxwv00iy2jqneit1egms' checked='checked'>
    <label for='ciux9lxwv00iy2jqneit1egms'>dark</label>
    <input id='ciux9qkuh00902ipheuxc1zw0' type='radio' name='rtoggle' value='ciux9qkuh00902ipheuxc1zw0'>
    <label for='ciux9qkuh00902ipheuxc1zw0'>satellite</label>
    <input id='ciukc013g004w2irrdrtpui3v' type='radio' name='rtoggle' value='ciukc013g004w2irrdrtpui3v'>
    <label for='ciukc013g004w2irrdrtpui3v'>streets</label>
</div>
<div class='map-overlay' id='features'><h2>JERSEY CITY BUILDING CENSUS</h2>
    <div id='pd'><p><i>A sort of love letter by <a href="https://twitter.com/sarahmakesmaps">Sarah Michael Levine.</a> <a href="http://www.sarahmakesmaps.com/blog/2016/6/mapping-jersey-city-ii-every-building" target = "_blank">Read more</a> about how this data was created and why it exists.</i><br>
    <p><strong>CONTROLS</strong></p>
        <p>Click on a building footprint for zone and parcel information.</p>
        <p>Use shift + up and down/left and right arrows to tilt map and pan.</p>
        <p>Right click and use mouse to spin.</p>
        <p>Hold shift key, click and drag to draw a bounding box to zoom to an area.</p>
        <p>Mobile browsing discouraged.<br></p>
    <p><strong>THINGS TO KNOW</strong></p>
        <p>For building info, click on building footprints (not the 3D shapes).</p>
        <p>Not all information exists for all buildings. Many fields are "undefined".</p>
    </div></div>
<div id='attribution'>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Jersey%20City%203D%20Building%20Map&via=sarahmakesmaps&url=https%3A%2F%2Fsml2198.github.io/JC-buildings/10-19-16.html.com%2F" target = "_blank">Tweet</a>
   © <a href= "http://www.sarahmakesmaps.com" target = "_blank">sarahmakesmaps.com</a> © <a href= "https://www.mapbox.com/about/maps/" target = "_blank">Mapbox</a> © <a href= "http://www.openstreetmap.org/about/" target = "_blank">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/#/-74.07214706629739/40.71655453008873/15" target = "_blank">Improve this map</a></strong>
</div>


<div id='zoning-legend' class='legend'>
    <strong><a href="http://www.cityofjerseycity.com/uploadedFiles/Data/Zoning%20Map%2020150527.pdf" target = "_blank">ZONE TYPES</a></strong><br>
    <div><span style='background-color: #A3BCF9'></span><a href = "http://www.jerseycitynj.gov/data.aspx?id=14834" target = "_blank" style="text-decoration:none">Special</a></div>
    <div><span style='background-color: #42e5f4'></span><a href = "https://www.municode.com/library/nj/jersey_city/codes/code_of_ordinances?nodeId=CH345ZO_ARTVZODEST_S345-40ONTWFAHODI" target = "_blank" style="text-decoration:none">Residential</a></div>
    <div><span style='background-color: #5A3A5A'></span><a href = "https://www.municode.com/library/nj/jersey_city/codes/code_of_ordinances?nodeId=CH345ZO_ARTVZODEST_S345-58HHIDI" target = "_blank" style="text-decoration:none">Historic</a></div>
    <div><span style='background-color: #847996'></span><a href = "https://www.municode.com/library/nj/jersey_city/codes/code_of_ordinances?nodeId=CH345ZO_ARTVZODEST_S345-45NCNECODI" target = "_blank" style="text-decoration:none">Commercial</a></div>
    <div><span style='background-color: #6666ff'></span><a href = "https://www.municode.com/library/nj/jersey_city/codes/code_of_ordinances?nodeId=CH345ZO_ARTVZODEST_S345-50IINDI" target = "_blank" style="text-decoration:none">Industrial</a></div>
    <div><span style='background-color: #660066'></span><a href = "https://www.municode.com/library/nj/jersey_city/codes/code_of_ordinances?nodeId=CH345ZO_ARTVZODEST_S345-54GGODI" target = "_blank" style="text-decoration:none">Government</a></div>
    <div><span style='background-color: #e6ccff'></span><a href = "https://www.municode.com/library/nj/jersey_city/codes/code_of_ordinances?nodeId=CH345ZO_ARTVZODEST_S345-52UUNDI" target = "_blank" style="text-decoration:none">University</div>
    <div><span style='background-color: #ADFF2F'></span><a href = "https://www.municode.com/library/nj/jersey_city/codes/code_of_ordinances?nodeId=CH345ZO_ARTVZODEST_S345-55POSPAOPSPDI" target = "_blank" style="text-decoration:none">Open Space</a></div>
    <div><span style='background-color: #d6ebf2'></span><a href = "https://www.municode.com/library/nj/jersey_city/codes/code_of_ordinances?nodeId=CH345ZO_ARTVZODEST_S345-53MMEDI" target = "_blank" style="text-decoration:none">Medical</a></div>
</div>


<style>
    body { margin:0; padding:0; }
    h2, h3 {
        margin: 10px;
        font-size: 2.4em;
        color: #FFFFFF;
        font-family: 'Montserrat', sans-serif;
    }
    h3 {
        font-size: .9em;
        color: #FFFFFF;
    }
    p {
        font-size: 0.95em;
        margin: 10px;
        text-align: left;
        color: #FFFFFF;
    }
    br {
        line-height: 190%;
     }
    strong {
        color: #a6a6a6;
    }
    a:link {
    color: #a6a6a6;
    }
    a:visited {
    color: #a6a6a6;        
    }
    a:hover {
    color: #a6a6a6;                
    }
#map {
    position:absolute;
    top:0;
    bottom:0;
    width:100%;
}
.map-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    margin-left: 7px;
    font-family: 'Roboto', sans-serif;
    overflow: auto;
    border-radius: 3px;
    font-size: 85%;
    color: #FFFFFF;
    background-color: #000000;
    opacity: 0.85;
}
#menu {   
    position: absolute;
    color: #FFFFFF;
    right: 0;
    top: 0;
    background-color: #000000;
    opacity: 0.7;
    padding: 5px;
    font-family: 'Roboto', sans-serif;   
    font-size: 75%;
    border-radius: 3px;
}
.legend {
    background-color: #000000;
    font-family: 'Roboto', sans-serif;   
    font-size: 70%;
    color: #FFFFFF;
    opacity: 0.8;
    border-radius: 3px;
    bottom: 32px;
    padding: 5px;
    position: absolute;
    right: 7px;
    width: 90px;
    height: 150px;
    z-index: 1;
}
.legend div span {
    border-radius: 1px;
    display: inline-block;
    height: 10px;
    margin-right: 5px;
    width: 10px;
    opacity: 0.6;
}
#features {
    top: 0;
    height: 55%;
    margin-top: 20px;
    width: 23%;
}
#attribution {
    position: absolute;
    bottom: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.7);
    font-family: 'Roboto', sans-serif; 
    color: #FFFFFF;
    background-color: #000000;
    padding: 5px;   
    font-size: 80%;
    opacity: 0.82;
    border-radius: 3px;
}

</style>

<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoic2FyYWhtbGV2aW5lIiwiYSI6IlAweXNYVEUifQ._dz0522LtBABUYyfqP503Q';
if (!mapboxgl.supported()) {
    alert('Your browser does not support Mapbox GL');
} else {
    var bounds = [
        [-74.122906, 40.684179], 
        [-74.012957, 40.772768] 
    ];

    var map = new mapboxgl.Map({
        container: 'map',
        minZoom: 14,
        zoom: 14.1,
        center: [-74.0495, 40.7204],
        pitch: 48.53,
        bearing: -24.50,
        hash: true, 
        maxBounds: bounds,
        attributionControl: false,
        style: 'mapbox://styles/sarahmlevine/ciux9lxwv00iy2jqneit1egms',
    });

    map.getCanvas().style.cursor = 'default';

    map.on('load', function() {

        map.setLight({color: "#FFFFFF", intensity: 0.45, position: [1.05, 135, 45]});

        var layers = ['Residential', 'Commercial', 'Historic', 'Industrial', 'Special', 'Open Space', 'Medical', 'Government', 'University'];
        var layerList = document.getElementById('menu');
        var inputs = layerList.getElementsByTagName('input');

        function switchLayer(layer) {
            var layerId = layer.target.id;
            map.setStyle('mapbox://styles/sarahmlevine/' + layerId );
            map.on('style.load', function() {
                loadbuildings();  
            });
        }

        for (var i = 0; i < inputs.length; i++) {
            inputs[i].onclick = switchLayer; 
        }

        map.on('click', function (e) {
          var states = map.queryRenderedFeatures(e.point, {
              layers: layers
        });
          if (states.length > 0) {
              document.getElementById('pd').innerHTML = "<h3>" 
                + "Zone: " + '<a href ="' + states[0].properties.zoningURL + '">' + states[0].properties.zone + '</a>' + "</h3><p>" 
                + "Ward: " + states[0].properties.ward +  "<br>" 
                + "Neighborhood: " + states[0].properties.neighborho +  "<br>" 
                + "Police District: " + states[0].properties.policeDist +  "<br>" 
                + "Parcel Mun-Bloc-Lot-Qual: " + states[0].properties.pamsPin +  "<br>"  
                + "Name: " + states[0].properties.name +  "<br>"  
                + "Address: " + states[0].properties.propLoc +  "<br>" 
                + "Year Built: " + states[0].properties.yearBuilt +  "<br>" 
                        + "Square Feet: " + states[0].properties.squareFeet +  "<br>" 
                + "Sale Price: " + states[0].properties.salePrice +  "<br>" 
                + "Sale Date: " + states[0].properties.saleDate +  "<br>"  
                + "Building Assessment: " + states[0].properties.bldgAssess +  "<br>" 
                + "Total Assessment: " + states[0].properties.totAssess +  "<br>"  
                + "Taxes: " + states[0].properties.taxes +  "<br>"  
                + "Owner: " + states[0].properties.ownerName +  "<br>" 
                    + "Owner Address: " + states[0].properties.ownerMail + ', ' + states[0].properties.ownerMail2 + "<br>" 
                + "Static URL: " + '<a href ="http://www.' + states[0].properties.bldgURL + '" target="_blank">' 
                    + "www." + " " + states[0].properties.bldgURL
                    + '</a>' + "<br>" 
                + "Credit: © OpenStreetMap contributors" + "<br>"
                + "<i>Want to propose an information update for this building? Fill out " + '<a href ="https://goo.gl/forms/zc57zuiDKh4Y3myq2" target="_blank">this form</a>' +  " and be sure to enter this building ID: " + states[0].properties.identifier + ".</i><br>";
          } else {
              document.getElementById('pd').innerHTML = '<p><i>A sort of love letter by Sarah Michael Levine. <a href="http://www.sarahmakesmaps.com/blog/2016/6/mapping-jersey-city-ii-every-building" target = "_blank">Read more</a> about how this data was created and why it exists.</i><br><strong>CONTROLS</strong></p><p>Click on a building footprint for zone and parcel information.</p><p>Use shift + up and down/left and right arrows to tilt map and pan.</p><p>Right click and use mouse to spin.</p><p>Hold shift key, click and drag to draw a bounding box to zoom to an area.</p><p>Mobile browsing discouraged.</p><p><strong>THINGS TO KNOW</strong></p><p>For building info, click on building footprints (not the 3D shapes).</p><p>Not all information exists for all buildings. Many fields are "undefined".</p>';
          }
        });
        loadbuildings()
    });

    // the 'building' layer in the mapbox-streets vector source contains building-height
    // data from OpenStreetMap.
    function loadbuildings() {
        map.addSource('Special', {
            type: 'vector',
            url: 'mapbox://sarahmlevine.sarahmlevine.1rz41on6'
        });
        map.addLayer({
            'id': 'Residential',
            'source': 'composite',
            'filter': ['==', 'zone', ('R-1' || 'R-1A' || 'R-1F' || 'R-2' || 'R-3' || 'R-4' || 'OR' || 'Caven Point')],
            'source-layer': 'buildings-1909vz',
            'type': 'fill',
            'minzoom': 14,
            'paint': {
                'fill-color': '#42e5f4',
                'fill-extrude-height': {
                    'type': 'identity',
                    'property': 'bldgHeight'
                },
                'fill-extrude-base': {
                    'type': 'identity',
                    'property': 'minHeight'
                },  
                'fill-opacity': .5
            }
        });
        map.addLayer({
            'id': 'Special',
            'source': 'composite',
            'filter': ['!=', 'zone', ('C' || 'CBD' || 'DT' || 'H' || 'G' || 'R-1' || 'R-1A' || 'R-1F' || 'R-2' || 'R-3' || 'R-4' || 'U' || 'OR' || 'Caven Point' || 'C/A' || 'HC' || 'NC' || 'P/O' || 'M' || 'I' || 'Marine Industrial' || 'Greenville Industrial' || 'Chapel Avenue Industrial Park' || 'PI' )],
            'source-layer': 'buildings-1909vz',
            'type': 'fill',
            'minzoom': 14,
            'paint': {
                'fill-color': '#A3BCF9',
                'fill-extrude-height': {
                    'type': 'identity',
                    'property': 'bldgHeight'
                },
                'fill-opacity': .6
            }
        });
        map.addLayer({
            'id': 'Commercial',
            'source': 'composite',
            'filter': ['==', 'zone', ('C/A' || 'CBD' || 'DT' || 'HC' || 'NC')],
            'source-layer': 'buildings-1909vz',
            'type': 'fill',
            'minzoom': 14,
            'paint': {
                'fill-color': '#847996',
                'fill-extrude-height': {
                    'type': 'identity',
                    'property': 'bldgHeight'
                },
                'fill-opacity': .6
            }
        });
        map.addLayer({
            'id': 'Historic',
            'source': 'composite',
            'filter': ['==', 'zone', 'H'],
            'source-layer': 'buildings-1909vz',
            'type': 'fill',
            'minzoom': 14,
            'paint': {
                'fill-color': '#310A31',
                'fill-extrude-height': {
                    'type': 'identity',
                    'property': 'bldgHeight'
                },
                'fill-opacity': .5
            }
        });
        map.addLayer({
            'id': 'Industrial',
            'source': 'composite',
            'filter': ['==', 'zone', ('Chapel Avenue Industrial Park' || 'Claremont Industrial' || 'Greenville Industrial' || 'Marine Industrial' || 'I' || 'PI')],
            'source-layer': 'buildings-1909vz',
            'type': 'fill',
            'minzoom': 14,
            'paint': {
                'fill-color': '#6666ff',
                'fill-extrude-height': {
                    'type': 'identity',
                    'property': 'bldgHeight'
                },
                'fill-opacity': .6
            }
        });
        map.addLayer({
            'id': 'University',
            'source': 'composite',
            'filter': ['==', 'zone', 'U'],
            'source-layer': 'buildings-1909vz',
            'type': 'fill',
            'minzoom': 14,
            'paint': {
                'fill-color': '#e6ccff',
                'fill-extrude-height': {
                    'type': 'identity',
                    'property': 'bldgHeight'
                },
                'fill-opacity': .6
            }
        });
        map.addLayer({
            'id': 'Government',
            'source': 'composite',
            'filter': ['==', 'zone', 'G'],
            'source-layer': 'buildings-1909vz',
            'type': 'fill',
            'minzoom': 14,
            'paint': {
                'fill-color': '#660066',
                'fill-extrude-height': {
                    'type': 'identity',
                    'property': 'bldgHeight'
                },
                'fill-opacity': .6
            }
        });
        map.addLayer({
            'id': 'Medical',
            'source': 'composite',
            'filter': ['==', 'zone', 'M'],
            'source-layer': 'buildings-1909vz',
            'type': 'fill',
            'minzoom': 14,
            'paint': {
                'fill-color': '#d6ebf2',
                'fill-extrude-height': {
                    'type': 'identity',
                    'property': 'bldgHeight'
                },
                'fill-opacity': .6
            }
        });
        map.addLayer({
            'id': 'Open Space',
            'source': 'composite',
            'filter': ['==', 'zone', ('C' || 'P/O')],
            'source-layer': 'buildings-1909vz',
            'type': 'fill',
            'minzoom': 14,
            'paint': {
                'fill-color': '#ADFF2F',
                'fill-extrude-height': {
                    'type': 'identity',
                    'property': 'bldgHeight'
                },
                'fill-opacity': .6
            }
        });
    };
}
</script>

</body>
</html>
